<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>手写 getQueryString</title>
</head>
<body>

</body>
<script>
  // https://developer.mozilla.org/zh-CN/docs/Web/API/URL

  function getQueryString(url, name = '') {
    if (!url) {
      return undefined;
    }

    const newUrl = new URL(url);
    const search = newUrl.search.substring(1);

    const splitArr = search.split('&');
    const result = {};

    for (let i = 0; i < splitArr.length; i++) {
      let [key, value] = splitArr[i].split('=');

      value = decodeURIComponent(value);

      if (key in result) {
        result[key] = Array.isArray(result[key]) ? result[key].concat(value) : [...result[key], value];
      } else {
        result[key] = value;
      }
    }

    return name ? result[name] : result;
  }

  const url1 = 'https://www.baidu.com/?id=100&name=AA&age=23&address=中国';
  const url2 = 'https://www.baidu.com/?id=100&name=AA&age=23&id=101&id=102';
  console.log(getQueryString(url1));
  console.log(getQueryString(url1, 'id'));
  console.log(getQueryString(url1, 'address'));

  console.log(getQueryString(url2));
  console.log(getQueryString(url2, 'id'));
</script>
</html>
